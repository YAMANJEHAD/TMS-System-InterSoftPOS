<div class="container-fluid">
  <h2 class="mb-4">Add Task</h2>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show" role="alert">
    {{ successMessage }}
    <button type="button" class="btn-close" (click)="dismissSuccess()"></button>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
    {{ error }}
    <button type="button" class="btn-close" (click)="dismissError()"></button>
  </div>

  <div class="card">
    <div class="card-body">
      <form (ngSubmit)="onSubmit()">
        <div class="mb-3">
          <label class="form-label">Title <span class="text-danger">*</span></label>
          <input type="text" class="form-control" [(ngModel)]="formData.title" name="title" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Description</label>
          <textarea class="form-control" [(ngModel)]="formData.description" name="description" rows="4"></textarea>
        </div>
        <div class="row">
          <div class="col-md-4 mb-3">
            <label class="form-label">Due Date <span class="text-danger">*</span></label>
            <input type="datetime-local" class="form-control" [(ngModel)]="formData.dueDate" name="dueDate" required>
          </div>
          <div class="col-md-4 mb-3">
            <label class="form-label">Status <span class="text-danger">*</span></label>
            <select class="form-select" [(ngModel)]="formData.statusId" name="statusId" required [disabled]="loadingFilters">
              <option [value]="0">Select Status</option>
              <option *ngFor="let status of statuses" [value]="status.statusId">
                {{ status.statusName }}
              </option>
            </select>
          </div>
          <div class="col-md-4 mb-3">
            <label class="form-label">Priority <span class="text-danger">*</span></label>
            <select class="form-select" [(ngModel)]="formData.priorityId" name="priorityId" required [disabled]="loadingFilters">
              <option [value]="0">Select Priority</option>
              <option *ngFor="let priority of priorities" [value]="priority.priorityId">
                {{ priority.priorityName }}
              </option>
            </select>
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label">Project <span class="text-danger">*</span></label>
          <select class="form-select" [(ngModel)]="formData.projectId" name="projectId" required [disabled]="loadingFilters">
            <option [value]="0">Select Project</option>
            <option *ngFor="let project of projects" [value]="project.projectId">
              {{ project.name }}
            </option>
          </select>
        </div>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label">IDs</label>
            <input type="text" class="form-control" [(ngModel)]="formData.ids" name="ids" placeholder="Comma-separated IDs">
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">File Name</label>
            <input type="text" class="form-control" [(ngModel)]="formData.fileName" name="fileName">
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label">File Path</label>
          <input type="text" class="form-control" [(ngModel)]="formData.filePath" name="filePath" placeholder="e.g., /path/to/file">
        </div>
        <div class="d-flex gap-2">
          <button type="submit" class="btn btn-primary" [disabled]="loading || loadingFilters">
            <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
            {{ loading ? 'Creating...' : 'Create Task' }}
          </button>
          <button type="button" class="btn btn-secondary" (click)="router.navigate(['/tasks'])">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>

